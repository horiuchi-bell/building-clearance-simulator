# 建築限界シミュレーター

## 概要
OIRANシミュレーターのExcelファイルを解析して作成された、カント・曲線半径に応じた建築限界モデルの視覚的表示アプリケーションです。

## 機能
- ✅ 正確な建築限界モデル（寸法図準拠）
- ✅ カント値による傾き変形（-200mm ～ +200mm）
- ✅ 曲線半径による拡幅変形（0m ～ 2000m）
- ✅ 設備位置測定・判定機能
- ✅ リアルタイム支障・安全判定
- ✅ 日本語完全対応インターフェース

## ファイル構成

### メインアプリケーション
- `complete_clearance_app.py` - **完全統合版GUI（推奨）**
- `clearance_demo.py` - コマンドライン デモ版

### 解析ツール
- `excel_analyzer.py` - OIRAN Excel基本解析
- `detailed_analyzer.py` - 詳細シート解析  
- `formula_extractor.py` - 数式・三角関数抽出
- `building_clearance_extractor.py` - 形状データ抽出
- `accurate_clearance_model.py` - 建築限界モデルクラス

### データファイル
- `building_clearance_data.json` - 抽出された建築限界データ
- `clearance_demo_data.json` - テストケースデータ
- `clearance_simulation_demo.png` - 可視化プロット

## 実行方法

### GUI版（推奨）
```bash
python3 complete_clearance_app.py
```

### デモ版
```bash  
python3 clearance_demo.py
```

## 使用方法

### 1. 設備位置の入力
- **設備名**: 測定対象の設備名を入力
- **レール中心からの距離**: 測定値を入力（左側は負値、右側は正値）
- **レールレベルからの高さ**: 測定値を入力（レール面=0mm）

### 2. 軌道条件の設定
- **カント値**: -200mm ～ +200mm
- **曲線半径**: 0m（直線） ～ 2000m

### 3. 判定結果の確認
- **建築限界ランク**: A（支障）～ E（正常）
- **設備状態**: 限界内 or 支障
- **余裕距離**: 建築限界からの距離

## 技術仕様

### 建築限界モデル
- **基準**: 在来・一般・片線用
- **寸法**: 寸法図「備考２」の単純直線部分準拠
- **座標系**: レール中心・レールレベル基準

### 変形計算
- **カント変形**: `角度 = arctan(カント値/1067mm)`
- **曲線拡幅**: `拡幅量 = min(100, 1500/半径)`

### 主要寸法
- **全幅**: 3250mm
- **最大高さ**: 4650mm
- **中央部最小幅**: ±1000mm（高さ2600mm）

## 解析結果

### OIRANシミュレーター解析
- **240個の三角関数**を抽出
- **158個の座標変換数式**を解析
- **1444個の座標ペア**を取得

### 検証済み機能
- カント140mm → 傾斜角7.48°
- 曲線R=300m → 拡幅5.0mm
- 複合条件（カント + 曲線）対応

## 対応環境
- Python 3.6+
- tkinter（GUI版）
- matplotlib
- numpy
- Linux/Windows/macOS

## 作成者
Claude Code (Anthropic)
建築限界プロジェクト - 2025年7月23日